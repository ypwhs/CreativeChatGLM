# ğŸ’¡Creative ChatGLM WebUI

ğŸ‘‹ æ¬¢è¿æ¥åˆ° ChatGLM åˆ›æ„ä¸–ç•Œï¼ä½ å¯ä»¥ä½¿ç”¨ä¿®è®¢å’Œç»­å†™çš„åŠŸèƒ½æ¥ç”Ÿæˆåˆ›æ„å†…å®¹ï¼

* ğŸ“– ä½ å¯ä»¥ä½¿ç”¨â€œç»­å†™â€æŒ‰é’®å¸® ChatGLM æƒ³ä¸€ä¸ªå¼€å¤´ï¼Œå¹¶è®©å®ƒç»§ç»­ç”Ÿæˆæ›´å¤šçš„å†…å®¹ã€‚
* ğŸ“ ä½ å¯ä»¥ä½¿ç”¨â€œä¿®è®¢â€æŒ‰é’®ä¿®æ”¹æœ€åä¸€å¥ ChatGLM çš„å›å¤ã€‚

# ç¯å¢ƒé…ç½®

## ç¦»çº¿åŒ…

æ­¤å®‰è£…æ–¹æ³•é€‚åˆï¼š

* éå¼€å‘äººå‘˜ï¼Œä¸éœ€è¦å†™ä»£ç 
* æ²¡æœ‰Pythonç»éªŒï¼Œä¸ä¼šæ­å»ºç¯å¢ƒ
* ç½‘ç»œç¯å¢ƒä¸å¥½ï¼Œé…ç½®ç¯å¢ƒã€ä¸‹è½½æ¨¡å‹é€Ÿåº¦æ…¢

| åç§° | æ–‡ä»¶å | å¤§å° | ç™¾åº¦ç½‘ç›˜ | å¤‡æ³¨ |
| ---- | ---- | ---- | ---- | ---- |
| **å°æ˜¾å­˜ç¦»çº¿åŒ…** | CreativeChatGLM_<br/>py310_torch200_<br/>chatglm_6b_int4.zip | 5.55 GB | [ç‚¹å‡»ä¸‹è½½](https://pan.baidu.com/s/1I_KqxWyjO1ksL-wzXZ0JCA?pwd=cglm) | ä½¿ç”¨ ChatGLM-6B-int4 æƒé‡çš„ç¦»çº¿åŒ…ï¼Œ<br/>æ˜¾å­˜éœ€æ±‚ 8GB |
| å¤§æ˜¾å­˜ç¦»çº¿åŒ… | CreativeChatGLM_<br/>py310_torch200_<br/>chatglm_6b.zip | 14.3 GB | [ç‚¹å‡»ä¸‹è½½](https://pan.baidu.com/s/1wPldt4CY783-JOF80eF7bg?pwd=cglm) | ä½¿ç”¨ ChatGLM-6B æƒé‡çš„ç¦»çº¿åŒ…ï¼Œ<br/>æ˜¾å­˜éœ€æ±‚ 16GB |
| ç¯å¢ƒç¦»çº¿åŒ… | CreativeChatGLM_<br/>py310_torch200_<br/>chatglm_6b.zip | 2.56 GB | [ç‚¹å‡»ä¸‹è½½](https://pan.baidu.com/s/1v3RWNFCIBQGe0yPBfYTjxQ?pwd=cglm) | ä¸å¸¦æƒé‡çš„ç¦»çº¿åŒ…ï¼Œå¯åŠ¨ä¹‹åå¯ä»¥<br/>è‡ªåŠ¨ä¸‹è½½æ¨¡å‹ï¼Œé»˜è®¤è‡ªåŠ¨ä¸‹è½½ <br/>ChatGLM-6B æƒé‡ã€‚ |
| ChatGLM-6B | chatglm-6b.zip | 11.7 GB | [ç‚¹å‡»ä¸‹è½½](https://pan.baidu.com/s/1gqG9a_nnglRouA8yF9KPgA?pwd=cglm) | [THUDM/chatglm-6b](https://huggingface.co/THUDM/chatglm-6b) |
| ChatGLM-6B-int4 | chatglm-6b-int4.zip | 2.99 GB | [ç‚¹å‡»ä¸‹è½½](https://pan.baidu.com/s/1TXlGUKxKr7EM4oaKWiVSqw?pwd=cglm) | [THUDM/chatglm-6b-int4](https://huggingface.co/THUDM/chatglm-6b-int4) |

å¦‚æœä¸Šé¢æ²¡æœ‰ä½ æƒ³è¦çš„ï¼Œå¯ä»¥åœ¨è¿™é‡Œçœ‹çœ‹ï¼š

* ç™¾åº¦ç½‘ç›˜é“¾æ¥ï¼š[https://pan.baidu.com/s/1pnIEj66scZOswHm8oivXmw?pwd=cglm](https://pan.baidu.com/s/1pnIEj66scZOswHm8oivXmw?pwd=cglm)

<details><summary>ç‚¹å‡»æŸ¥çœ‹è¯¦ç»†æ­¥éª¤</summary>

ä¸‹è½½å¥½ç¯å¢ƒåŒ…ä¹‹åï¼Œè§£å‹ï¼Œç„¶åè¿è¡Œ `start_offline.bat` è„šæœ¬ï¼Œå³å¯å¯åŠ¨æœåŠ¡ï¼š

![image](https://user-images.githubusercontent.com/10473170/227984407-cdf8ba61-e4e0-4838-a34f-07de18cb37fc.png)

</details>

## è™šæ‹Ÿç¯å¢ƒ

æ­¤å®‰è£…æ–¹æ³•é€‚åˆå·²ç»å®‰è£…äº† Pythonï¼Œä½†æ˜¯å¸Œæœ›ç¯å¢ƒä¸ç³»ç»Ÿå·²å®‰è£…çš„ Python ç¯å¢ƒéš”ç¦»çš„ç”¨æˆ·ã€‚

<details><summary>ç‚¹å‡»æŸ¥çœ‹è¯¦ç»†æ­¥éª¤</summary>

é¦–å…ˆå¯åŠ¨ `setup_venv.bat` è„šæœ¬ï¼Œå®‰è£…ç¯å¢ƒï¼š

![image](https://user-images.githubusercontent.com/10473170/227982667-a8090ffa-f836-4ebc-93a1-91ab39d9259b.png)

ç„¶åä½¿ç”¨ `start_venv.bat` è„šæœ¬å¯åŠ¨æœåŠ¡ï¼š

![image](https://user-images.githubusercontent.com/10473170/227983154-27ed9751-b9c3-44ec-9583-31f192955b11.png)

</details>

## Python å¼€å‘ç¯å¢ƒ

æ­¤é¡¹é…ç½®æ–¹æ³•é€‚åˆä»£ç å¼€å‘äººå‘˜ï¼Œä½¿ç”¨çš„æ˜¯è‡ªå·±ç³»ç»Ÿé‡Œå®‰è£…çš„ Pythonã€‚

ç¯å¢ƒé…ç½®å‚è€ƒå®˜æ–¹é“¾æ¥ï¼š[https://github.com/THUDM/ChatGLM-6B](https://github.com/THUDM/ChatGLM-6B)

é…ç½®å¥½ä¹‹åï¼Œè¿è¡Œ `app.py` å¼€å§‹ä½¿ç”¨ï¼Œæˆ–è€…ä½¿ç”¨ IDE å¼€å§‹å¼€å‘ã€‚

# ç”¨æ³•ä»‹ç»

## ç»­å†™

### åŸå§‹å¯¹è¯

å¦‚æœä½ ç›´æ¥é—® ChatGLMï¼šâ€œä½ å‡ å²äº†ï¼Ÿâ€

å®ƒåªä¼šå›ç­”ï¼šâ€œä½œä¸ºä¸€ä¸ªäººå·¥æ™ºèƒ½è¯­è¨€æ¨¡å‹ï¼Œæˆ‘æ²¡æœ‰å¹´é¾„ï¼Œæˆ‘åªæ˜¯ä¸€ä¸ªæ­£åœ¨ä¸æ–­å­¦ä¹ å’Œè¿›åŒ–çš„ç¨‹åºã€‚â€

<img width="388" alt="image" src="https://user-images.githubusercontent.com/10473170/227778266-e7f2b55a-59de-4eee-bfa2-f28f911ec018.png">

### ç»­å†™å¯¹è¯

è€Œå¦‚æœä½ ç»™å®ƒèµ·ä¸ªå¤´ï¼šâ€œæˆ‘ä»Šå¹´â€

å®ƒå°±ä¼šå›ç­”ï¼šâ€œæˆ‘ä»Šå¹´21å²ã€‚â€

<img width="388" alt="image" src="https://user-images.githubusercontent.com/10473170/227778334-d459ad8d-7c16-466d-851c-5af174216773.png">

### ä½¿ç”¨è§†é¢‘

![ChatGLM2](https://user-images.githubusercontent.com/10473170/227778636-a8fcd650-eeeb-44e5-8f24-9260b27cce5d.gif)

## ä¿®è®¢

### åŸå§‹å¯¹è¯

å¦‚æœä½ ç›´æ¥è·Ÿ ChatGLM è¯´ï¼šâ€œä½ æ˜¯è°ï¼Ÿâ€

å®ƒä¼šå›ç­”ï¼šâ€œæˆ‘æ˜¯ä¸€ä¸ªåä¸º ChatGLM-6B çš„äººå·¥æ™ºèƒ½åŠ©æ‰‹ï¼Œæ˜¯åŸºäºæ¸…åå¤§å­¦ KEG å®éªŒå®¤å’Œæ™ºè°± AI å…¬å¸äº 2023 å¹´å…±åŒè®­ç»ƒçš„è¯­è¨€æ¨¡å‹å¼€å‘çš„ã€‚æˆ‘çš„ä»»åŠ¡æ˜¯é’ˆå¯¹ç”¨æˆ·çš„é—®é¢˜å’Œè¦æ±‚æä¾›é€‚å½“çš„ç­”å¤å’Œæ”¯æŒã€‚â€

ä½ å†é—®å®ƒï¼šâ€œä½ å‡ å²äº†ï¼Ÿâ€

å®ƒåªä¼šè¯´ï¼šâ€œä½œä¸ºä¸€ä¸ªäººå·¥æ™ºèƒ½åŠ©æ‰‹ï¼Œæˆ‘æ²¡æœ‰å¹´é¾„ï¼Œå› ä¸ºæˆ‘åªæ˜¯ä¸€ä¸ªç¨‹åºï¼Œæ²¡æœ‰å®é™…çš„è‚‰ä½“æˆ–ç”Ÿå‘½ã€‚æˆ‘åªæ˜¯ä¸€ä¸ªåœ¨è®¡ç®—æœºä¸Šè¿è¡Œçš„ç¨‹åºï¼Œä¸“é—¨è®¾è®¡ä¸ºå›ç­”ç”¨æˆ·çš„é—®é¢˜å’Œæä¾›ç›¸å…³çš„å¸®åŠ©ã€‚â€

![image](https://user-images.githubusercontent.com/10473170/227777039-75b9dfb6-9b83-45af-8555-c3a27808c683.png)

### ä¿®æ”¹å¯¹è¯

ä½ å¯ä»¥æ”¹å˜å®ƒçš„è§’è‰²ï¼Œæ¯”å¦‚ä½ é€šè¿‡â€œä¿®è®¢â€åŠŸèƒ½ï¼Œå°†å®ƒçš„å›å¤æ”¹æˆï¼šâ€œæˆ‘æ˜¯æ¨å¼€å¿ƒã€‚â€

ç„¶åä½ å†é—®å®ƒï¼šâ€œä½ å‡ å²äº†ï¼Ÿâ€

å®ƒå°±ä¼šå›ç­”ï¼šâ€œæˆ‘ä»Šå¹´15å²ã€‚â€

![image](https://user-images.githubusercontent.com/10473170/227777136-e2a176f8-6742-41a9-abaf-72a9540b834d.png)

### ä½¿ç”¨è§†é¢‘

![æœªå‘½åé¡¹ç›®](https://user-images.githubusercontent.com/10473170/227777930-6aa5981a-0695-40c7-b083-b76bb063c481.gif)

# å®ç°åŸç†

è¿™ä¸ªæ–¹æ³•å¹¶æ²¡æœ‰è®­ç»ƒï¼Œæ²¡æœ‰ä¿®æ”¹å®˜æ–¹å‘å¸ƒçš„æƒé‡ï¼Œè€Œåªæ˜¯å¯¹æ¨ç†çš„å‡½æ•°åšäº†ä¿®æ”¹ã€‚

ç»­å†™çš„åŸç†æ˜¯ï¼Œå°†ç”¨æˆ·çš„è¾“å…¥ç›´æ¥è®¾ç½®ä¸º `history[-1][1]`ï¼Œæ¨¡æ‹Ÿæ¨¡å‹è‡ªå·±çš„éƒ¨åˆ†è¾“å‡ºï¼Œç„¶åç»§ç»­èµ°ä¹‹åçš„æ¨ç†å‡½æ•° `stream_chat_continue` [code](https://github.com/ypwhs/CreativeChatGLM/blob/a5c6dd1/chatglm/modeling_chatglm.py#L1158)ã€‚

ä¿®è®¢çš„åŸç†æ˜¯ï¼Œå°†ç”¨æˆ·çš„è¾“å…¥ç›´æ¥è®¾ç½®ä¸º `history[-1][1]`ï¼Œæ¨¡æ‹Ÿæ¨¡å‹è‡ªå·±çš„å®Œæ•´è¾“å‡ºï¼Œä½†æ˜¯ä¸èµ°æ¨ç†å‡½æ•°ã€‚

# ç¦»çº¿åŒ…åˆ¶ä½œæ–¹æ³•

## å‡†å¤‡ Python

é¦–å…ˆå» Python å®˜ç½‘ä¸‹è½½ï¼š[https://www.python.org/downloads/](https://www.python.org/downloads/)

![image](https://user-images.githubusercontent.com/10473170/229679144-86d96c5c-58e0-4a54-9657-ccfe37943c6e.png)

æ³¨æ„è¦ä¸‹è½½ `Windows embeddable package (64-bit)` ç¦»çº¿åŒ…ï¼Œæˆ‘é€‰æ‹©çš„æ˜¯ [python-3.10.10-embed-amd64.zip](https://www.python.org/ftp/python/3.10.10/python-3.10.10-embed-amd64.zip)ã€‚

![image](https://user-images.githubusercontent.com/10473170/229679189-1f8b2032-c92c-47ee-ba25-147f4acbf90f.png)

è§£å‹åˆ° `./system/python` ç›®å½•ä¸‹ã€‚

![image](https://user-images.githubusercontent.com/10473170/229679264-b3633920-757f-4ab8-b9f8-e79a21036146.png)

## å‡†å¤‡ get-pip.py

å»å®˜ç½‘ä¸‹è½½ï¼š[https://bootstrap.pypa.io/get-pip.py](https://bootstrap.pypa.io/get-pip.py)

ä¿å­˜åˆ° `./system/python` ç›®å½•ä¸‹ã€‚

## å®‰è£…ä¾èµ–

è¿è¡Œ [setup_offline.bat](setup_offline.bat) è„šæœ¬ï¼Œå®‰è£…ä¾èµ–ã€‚

# åè®®

æœ¬ä»“åº“çš„ä»£ç ä¾ç…§ [Apache-2.0](LICENSE) åè®®å¼€æºï¼ŒChatGLM-6B æ¨¡å‹çš„æƒé‡çš„ä½¿ç”¨åˆ™éœ€è¦éµå¾ª [Model License](MODEL_LICENSE)ã€‚
